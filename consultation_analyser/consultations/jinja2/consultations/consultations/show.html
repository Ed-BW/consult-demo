{% extends "base.html" %}
{%- from "govuk_frontend_jinja/components/breadcrumbs/macro.html" import govukBreadcrumbs -%}
{%- from 'govuk_frontend_jinja/components/button/macro.html' import govukButton -%}

{% set page_title = "Dashboard" %}

{% block content %}

  <h1 class="govuk-heading-m">{{ page_title }}</h1>
  {{ govukBreadcrumbs({
    "items": [
      {
        "text": "Back to your consultations",
        "href": "/consultations",
      }
    ]
  }) }}

  {%- from "govuk_frontend_jinja/components/breadcrumbs/macro.html" import govukBreadcrumbs -%}

  <div class="govuk-grid-row">
    <div class="govuk-grid-column-three-quarters">

      <div class="govuk-grid-row">
        <div class="govuk-grid-column-full">
          {% for question_dict in all_questions %}
            <div class="iai-panel govuk-!-margin-bottom-4">
              <span class="govuk-caption-m "><a class="govuk-link" href="{{ url('question_responses', kwargs={'consultation_slug': consultation.slug, 'question_slug': question_dict.question.slug}) }}">Question {{ question_dict.question.number }}</a></span>
              <h2 class="govuk-heading-m govuk-!-margin-top-1">{{ question_dict.question.text }}</h2>

              {% if question_dict.free_text_answers %}
                  <h3 class="govuk-heading-s">Free text response</h3>
                  <p class="govuk-body" style="display: flex;align-items:center;gap: 0.6%">
                    <img src="/public/images/thumbs-up-down.svg"/>
                  </p>

                  <p class="govuk-body govuk-!-margin-bottom-2">Top themes</p>

                  <div class="govuk-pill-container" style="display: flex;align-items:center;gap: 0.6%">
                    {# Loop through the framework results and display the top themes #}
                    {% for theme, count in question_dict["theme_counts"].items() %}
                      <div class="govuk-pill">
                        <tool-tip class="iai-tooltip">
                          <div class="iai-tooltip__button">
                            <span>{{ theme.name }}</span>
                            <img src="/public/images/question-mark.svg" alt="" width="14"/>
                          </div>
                          <div class="iai-tooltip__content">
                            {{ theme.description }}
                          </div>
                        </tool-tip>
                      </div>
                    {% endfor %}
                  </div>
              {% else %}
                <p class="govuk-body">This question does not have a free text responses</p>
              {% endif %}

              <hr class="govuk-section-break govuk-section-break--m govuk-section-break--visible">

            </div>
          {% endfor %}

        </div>
      </div>

    </div>
  </div>

{% endblock %}
